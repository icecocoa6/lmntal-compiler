%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% - 構文解析器のテスト

a(-3.14*. .14E-04+ -5)

p(10-6-3.14* -3.14)

p("a\"\\b")

p('a''b')

#"A" % ==> 65【未実装】

p([1,2,3|X],[4,5],[],result(X))

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% - 基本テスト

append(c(1,c(2,c(3,n))),c(4,c(5,n)),result), ( append(X,Y,Z), n(X) :- Y=Z ), ( append(X,Y,Z), c(A,X1,X) :- c(A,Z1,Z), append(X1,Y,Z1) )

append(c(1,c(2,c(3,n))),c(4,c(5,n)),result).
append(X,Y,Z), n(X) :- Y=Z.
append(X,Y,Z), c(A,X1,X) :- c(A,Z1,Z), append(X1,Y,Z1).

append([1,2,3],[4,5],result), ( Z=append([],Y) :- Y=Z ), ( Z=append([A|X],Y) :- Z=[A|append(X,Y)] )

append([1,2,3],[4,5],result).
Z=append([],Y) :- Y=Z.
Z=append([A|X],Y) :- Z=[A|append(X,Y)].

[[/*inline*/System.out.println(me.nth(0));]]("Linked\n\tMultisets of\n\t\tNodes")

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% - 単一化 = のテスト

p(X,X)
p(X,Y),Y=X % ==> p(X,X)
X=X        % ==> ()
X=Y,Y=X    % ==> ()
[1]=res    % ==> res([1])
X=[1|X]

p(a,b), ( p(X,Y)     :- X=Y     ) % ==> a(b)
p(a,b), ( Y=p(X)     :- X=Y     ) % ==> a(b)
p(a,b), ( Y=E,E=p(X) :- X=F,F=Y ) % ==> a(b)

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% - 自由リンク管理アトムのテスト

% 生成のテスト
b(X),{c(X)}
% マッチングのテスト
b(X),{c(X)}, (b(X),{c(X)}:- ok) % ==> ok
% 生成とマッチングのテスト
a, (a:-b(X),{c(X)}), (b(X),{c(X)}:-d(Y),{e(Y)}) % ==> d(X),{e(X)}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% - プロセス文脈のテスト

1,1,1,1,1,{},({$p},1:-{$p,1}) % ==> {1,1,1,1,1}
{{a(X)},b(X,Y),1},{c(Y)}, ({$p,1} :- {$p}) % ==> {{a(X)},b(X,Y)},{c(Y)}

% RemoveProxies のテスト
{{a(X)},b(X,Y)},{c(Y)},      ({$p},{$q} :- {$p,$q}) % ==> {{a(X)},c(b(X))}
% RemoveToplevelProxies のテスト
{a(  X)},{b(X)},             ({$p},{$q} :-  $p,$q ) % ==> a(b)
{a(A,X)},{b(X)},c(A),        ({$p},{$q} :-  $p,$q ) % ==> b(a(c))

% InsertProxies のテスト
{{a(A,X)},b(B,X)},c(A,B), ({{$p},$q} :- {$p,$q}) %

% 全般
{{a(A,X)},b(B,X)},{d(B)},c(A),  ( {{$p},$q},{$r}   :- {{$p},$q,  $r} ) % ==> {{a(A,X)},b(d,X)},c(A)
{{a(A,X)},b(B,X)},{d(B)},c(A),a,( {{$p},$q},{$r},a :- {{$p},$q},{$r} ) % ==> {{a(A,X)},b(B,X)},{d(B)},c(A)
{{a(A,X)},b(B,X)},{d(B)},c(A),  ( {{$p},$q},{$r}   :- {$p,$q,$r}     ) % ==> {a(X,b(d))},c(X)
{{a(A,X)},b(B,X)},{d(B)},c(A),  ( {{$p},$q},{$r}   :-  $p,$q,$r      ) % ==> a(c)=b(d)

{{a(X)},b(X)},               ({{$p},$q} :- $p,$q) % ==> a(b)
{{a(X)},b(X,Y)}, c(Y),       ({{$p},$q} :- $p,$q) % ==> c(b(a))
{{a(A,X)},b(B,X)},1(A),2(B), ({{$p},$q} :- $p,$q) % ==> a(1)=b(2)

{a(A,X)},{b(X)},{c(A)},      ({$p},{$q} :- {$p,$q}) % ==> {b(a(c))}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% - ルール文脈のテスト

{@p}:-@p.  a. {a:-b}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% - システムルールセットのテスト

{p(X,Y), (p(X,Y) :- X=Y)}, a(X,Y) % ==>  a(X,X), {}
{a(X,Y)}, p(X,Y), (p(X,Y) :- X=Y) % ==> {a(X,X)}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% - 組み込み機能のテスト

p((123-45+67-89)/(10*10)) % ==> 1
cp(4+5,B,C), res(B*C)     % ==> res(81)
p(2/0)                    % ==> p(2/0)
p(2 mod 0)                % ==> p(2 mod 0)
p(float(2)+. 1.0 +..14)   % ==> p(3.14)

p(0.0/.0.0), (p('NaN')       :- err) % ==> p('NaN')【要調整】
p(4.0/.0.0), (p('Infinity')  :- err) % ==> p('Infinity')【要調整】
p(-4.0/.0.0),(p('-Infinity') :- err) % ==> p('-Infinity')【要調整】
p(1.0/.(-4.0/.0.0)), (p(0.0) :- err) % ==> p(-0.0)

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% - ガードのテスト

(a($p) :- int($p) | b($p))

(a(X) :- int(X)      | b(X),c(X))
(a(X) :- int(X)      | b(X),c(X)), a(4)      % ==> b(4),c(4)

(a(X) :- 4(X),4(X)   | end(X)),    a(4),a(5) % ==> end(4),a(5)
(a    :- 4(X),4(X)   | end(X)),    a         % ==> end(4)
(a(X) :- 4(X),int(X) | end(X)),    a(4)      % ==> end(4)

(a(X,Y) :- X<Y | ok(X,Y)), a(3,4), a(3,3), a(3,2) % ==> ok(3,4), a(3,3), a(3,2)

(a(X) :- X=4         | end(X)),    a(4),a(5) % ==> end(4),a(5)
(a(X) :- 4=X         | end(X)),    a(4),a(5) % ==> end(4),a(5)

(a($p):- $p=4        | end($p)),   a(4),a(5) % ==> end(4),a(5)

(gen(1) :- X=X),(gen(N) :- N>1 | p(N),gen(N-1)), gen(50), (p(A),p(B) :- B=(B/A)*A | p(A)) 
(gen(1) :- X=X),(gen(N) :- N>1 | p(N),gen(N-1)), gen(50), (p(A),p(B) :- B mod A =:= 0 | p(A)) 
(gen(1) :- X=X),(gen(N) :- N>1 | p(N),gen(N-1)), gen(200), (p(A),p(B) :- B mod A =:= 0 | p(A)) 

%

(f(X):- X >. 3.0 | ok(X)), f(3.0+.0.1),f(3.0),f(2.9),f(3) % 

(p(X) :- X==4 | ok), p(4),p(5) % ==> ok,p(5)
(p(X) :- 4==X | ok), p(4),p(5) % ==> ok,p(5)
(p(X) :- X =:=. 4.0 | ok), p(4),p(4.0) % ==> ok,p(4)

(a :- $p=1 | $p=$p), a % ==> 1(1)
 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 明示的な自由リンク引数付きのプロセス文脈のテスト

( {$p[X|*A]} :- $p[X|*A] ), {a(X)},b(X) % ==> a(b)
( {$p[X|*A]} :- $p[X|*B] ), {a(X)},b(X) %【現在リンク束の名前は無視される】

( {$p[X|*A],a(X)} :- $p[X|*A],ok(X) ), {a(4)}        % ==> ok(4)
( {$p[X|*A],a(X)} :- $p[X|*A],ok(X) ), {a(X),{4(X)}} % ==> ok(X),{4(X)}
( {$p[X|*A],a(X)} :- $p[X|*A],ok(X) ), {a(X)},4(X)   % ==> {a(X)},4(X)

( {$p[Y|*A],a(X)} :- $p[X|*A],ok(Y) ), {a(X),b(X)}        % ==> {a(X),b(X)}        == {a(b)}
( {$p[Y|*A],a(X)} :- $p[X|*A],ok(Y) ), {a(X),b(X,Y)},f(Y) % ==> {a(X),b(X,Y)},f(Y) == {b(a,Y)},f(Y)
( {$p[Y|*A],a(X)} :- $p[X|*A],ok(Y) ), {a(X),b(Y)},f(X,Y) % ==> ok(Y),b(X),f(X,Y)  == ok(f(b))

( {$p[X],   a(X)} :- $p[X],   ok(X) ), {a(4)}        % ==> ok(4)
( {$p[X],   a(X)} :- $p[X],   ok(X) ), {a(X),{4(X)}} % ==> ok(X),{4(X)}
( {$p[X],   a(X)} :- $p[X],   ok(X) ), {a(X)},4(X)   % ==> {a(X)},4(X)

( {$p[Y|*A],a(Y)} :- $a=4 | $p[X|*A], $a=X ), {a(b)} % ==> b(4)
			
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

( {f($p)} :- int($p) | ok ), {f(2)},{f(3),a},{f(X)},1(X) % ==> ok,{f(3),a},{f(X)},1(X)

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

(sum([],S) :- S=0), (sum([A|Xs],S):-S=A+sum(Xs)), sum([1,2,3,4,5])=print

(gen(K,N,Xs) :- K=N | Xs=[]),(gen(K,N,Xs) :- K<N | Xs=[K|gen(K+1,N)]), gen(3,8)=print

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%