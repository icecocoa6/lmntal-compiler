% 共通する操作．
{
module(common).

	% 参照を消す
	common.rmref(R), {'+'(R), $data} :- {$data}.
	common.rmref(v(N)) :- int(N) | ().

	% 参照を複製する
	common.cpref(R1, R2, R), {'+'(R), $data} :- {'+'(R1), '+'(R2), $data}.
	
	R=common.str_of_functor(normalfunc(Name), Arity) :-
		R=string.concat(Name, string.concat("_", string.str_of_int(Arity))).
	
	R=common.flatten([[C|R1]|R2]) :- R=[C|common.flatten([R1|R2])].
	R=common.flatten([[]|R2]) :- R=common.flatten(R2).
	R=common.flatten([]) :- R=[].

}.