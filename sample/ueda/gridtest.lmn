{phase1, gridtext:gridtext}.

{phase1, $p,@p}/ :- {
    /* garbage-collecting whitespaces and nils */
    q(' ',E,W,N,S) :- n(E), n(W), n(N), n(S).
    n(X),n(X) :-.

    /* the '-' connector */
    q('-',E,W,n,n) :- E=W.

    /* the '|' connector */
    q('|',n,n,N,S) :- N=S.

    /* the '+' connector */
    q('+',n,W,n,S) :- W=S.
    q('+',E,n,n,S) :- E=S.
    q('+',E,n,N,n) :- E=N.
    q('+',n,W,N,n) :- W=N.

    phase2, $p.
  }
